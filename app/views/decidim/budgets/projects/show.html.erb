<% add_decidim_meta_tags(
  title: translated_attribute(project.title),
  description: translated_attribute(project.description)
) %>

<%
edit_link(
  resource_locator([project.budget, project]).edit,
  :update,
  :project,
  project: project
)
%>

<% content_for :top do %>
  <div class="extended hero bg-primary mt-5">
    <div class="hero__container">
      <div class="row">
        <div class="columns small-centered large-10">
          <h1 class="heading2 hero-heading"><%= translated_attribute project.title %></h1>
        </div>
      </div>
      <div class="row">
        <div class="columns mediumlarge-6 mediumlarge-push-3">
          <div class="static__content text-left">
            <%= render partial: "details_table" %>

            <p><%= t(".voting_note_html") %></p>

            <p class="text-center">
              <%= link_to t(".start_voting"), vote_path, class: "button secondary large" %>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<div class="row column view-header">
  <%= link_to projects_path(filter_link_params), class: "small hollow" do %>
    <%= icon "chevron-left", class: "icon--small" %>
    <%= t(".view_all_projects") %>
  <% end %>
</div>

<div class="resource-intro">
  <div class="row" data-equalizer>
    <div class="columns mediumlarge-7">
      <div class="resource-image" data-equalizer-watch>
        <% if project.main_image && project.main_image.url %>
          <%= image_tag project.main_image.main.url, class:"project-image", alt: strip_tags(translated_attribute(project.title)) %>
        <% elsif category_image_path(project.category) %>
          <%= image_tag category_image_path(project.category), class:"project-image", alt: strip_tags(translated_attribute(project.title)) %>
        <% else %>
          <%= image_tag "decidim/budgets/project-default.jpg", class:"project-image", alt: strip_tags(translated_attribute(project.title)) %>
        <% end %>
      </div>
    </div>
    <div class="columns mediumlarge-4">
      <div class="actionbox" data-equalizer-watch>
        <%= render partial: "project_actions", locals: { project: project } %>
      </div>
    </div>
  </div>
</div>

<div class="resource-details">
  <div class="row">
    <div class="columns mediumlarge-7">
      <div class="resource-details-row">
        <div class="resource-detail">#<%= project.id %></div>
        <div class="resource-detail">
          <%= translated_attribute(project.budget.title) %>
        </div>
      </div>
      <% if component_settings.geocoding_enabled? && project.address.present? %>
        <div class="resource-details-row">
          <div class="resource-detail"><%= project.address %></div>
        </div>
      <% end %>
    </div>
    <div class="columns mediumlarge-4 text-right">
      <div class="resource-details-row">
        <div class="resource-detail"><%= l(project.created_at.to_date, format: :decidim_short) %></div>
      </div>
      <% if project.category.present? %>
        <div class="resource-details-row">
          <div class="resource-detail">
            <% if project.category.parent %>
              <%= translated_attribute(project.category.parent.name) %> -
            <% end %>
            <%= translated_attribute(project.category.name) %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="resource-title">
  <div class="row">
    <div class="columns mediumlarge-7">
      <h3 class="heading3"><%= decidim_sanitize(translated_attribute(project.title)) %></h3>
    </div>
  </div>
</div>

<div class="resource-body">
  <div class="row">
    <div class="columns">
      <div class="section static__content">
        <%= decidim_sanitize(translated_attribute(project.description)) %>
      </div>

      <%= attachments_for project %>

      <%= linked_resources_for project, :proposals, "included_proposals" %>
      <%= linked_resources_for project, :ideas, "included_ideas" %>
      <%= linked_resources_for project, :plans, "included_plans" %>
      <%= linked_resources_for project, :results, "included_projects" %>
    </div>
  </div>
</div>

<%= comments_for project %>
