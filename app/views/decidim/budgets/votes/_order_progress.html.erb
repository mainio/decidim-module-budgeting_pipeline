<div id="order-progress-<%= order.budget.id %>" class="order-progress" data-valid="<%= order.confirmed_valid?.to_json %>">
  <div class="row">
    <div class="columns mediumlarge-4">
      <table class="transparent mb-0">
        <tbody>
          <% if order.projects_rule? %>
            <tr>
              <td><%= t(".available_projects") %></td>
              <td class="text-right"><strong><%= order.available_allocation %></strong></td>
            </tr>
            <tr>
              <td><%= t(".allocated_projects") %></td>
              <td class="text-right"><%= order.confirmed_total %></td>
            </tr>
          <% else %>
            <tr>
              <td><%= t(".available_budget") %></td>
              <td class="text-right"><%= budget_to_currency order.available_allocation %></td>
            </tr>
            <tr>
              <td><%= t(".allocated_budget") %></td>
              <td class="text-right"><%= budget_to_currency order.confirmed_total %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div class="columns mediumlarge-4">
      <table class="transparent">
        <tbody>
          <% if order.projects_rule? %>
            <tr class="lead">
              <td><strong><%= t(".unused_projects") %></strong></td>
              <td class="text-right"><strong><%= order.unused_confirmed_allocation %></strong></td>
            </tr>
          <% else %>
            <tr class="lead">
              <td><strong><%= t(".unused_budget") %></strong></td>
              <td class="text-right"><strong><%= budget_to_currency order.unused_confirmed_allocation %></strong></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="columns mediumlarge-8">
      <div class="budget-summary__progressbox" data-current-allocation="<%= order ? order.confirmed_total : 0 %>">
        <div class="progress<%= " alert" if order.confirmed_allocation_exceeded? %> budget-progress"
          role="progressbar"
          aria-valuenow="<%= number_with_precision(order.confirmed_budget_percent.to_f, precision: 1) %>"
          aria-valuetext="<%= number_with_precision(order.confirmed_budget_percent.to_f, precision: 1) %>%"
          aria-valuemin="0"
          aria-valuemax="100">
          <div class="progress-meter budget-progress__meter" style="width: <%= order.confirmed_budget_percent > 100 ? 100 : order.confirmed_budget_percent.to_f.floor %>%">
            <span class="progress-meter-text progress-meter-text--right"><%= number_with_precision(order.confirmed_budget_percent.to_f.floor, precision: 1) %>%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
